{% extends 'base.html' %}
{% load humanize %}
{% block content %}
    

<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>سفارش</title>
  <style>

@import url('https://fonts.googleapis.com/css2?family=Vazirmatn&display=swap');

.required label:after{
    content: "*"
}

.cart {
  background: white;
  color: #312d79;
  padding: 15px;
  border-radius: 10px;
  max-width: 900px;
  margin: auto;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.cart-item {
  display: flex;
  justify-content: space-between;
  padding: 10px 0;
  border-bottom: 1px solid #eee;
}

.empty-cart {
  text-align: center;
  color: #3f3c7c;
  padding: 20px;
}

.total {
  margin-top: 15px;
  font-weight: bold;
  text-align: left;
}

/* -------------------- بخش پرداخت -------------------- */
.checkout {
  background: white;
  color: #312d79;
  padding: 20px;
  border-radius: 10px;
  max-width: 900px;
  margin: 30px auto;
  box-shadow: 0 4px 10px rgba(0,0,0,0.1);
}

.checkout h2 {
  margin-bottom: 20px;
}

.discount-box {
  margin-bottom: 20px;
  font-size: 14px;
}

.checkout-form {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.form-group {
  display: flex;
  flex-direction: column;
}

.form-group label {
  margin-bottom: 6px;
  font-size: 14px;
  font-weight: bold;
}

.form-group input,
.form-group select,
.form-group textarea {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 8px;
  font-family: Vazirmatn, sans-serif;
  font-size: 14px;
}

.form-group.full-width {
  grid-column: span 2;
}

.form-submit {
  grid-column: span 2;
  text-align: left;
}

  </style>
</head>
<body>

<br><br><br>

<div class="cart">
  <h2>🛒 سبد خرید</h2>
      <table class="table table-striped">
        <thead>
            <tr>
                <th scope="col">عکس</th>
                <th scope="col">محصول</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart %}
              {% with product=item.product  %}
                <tr>
                    <td>
                            <img class="rounded-lg shadow" src="{{product.image.url}}" height="100" width="100" alt="">
                        </a>
                    </td>
                    <td>{{product.name}}</td>
                </tr>
              {% endwith %}
            {% endfor %}                
        </tbody>
    </table>
  <div id="cart-items">
                <tr>
                <td>مجموع</td>
                <td colspan="4"></td>
                <td>{{cart.get_total_price|intcomma}}</td>
                </tr>
  </div>
</div>

<div class="checkout">
<h2>💳 پرداخت</h2>    
    <div class="form-group">
    <form method="POST" id="checkout-form" class="checkout-form">
        {{form.as_p}}
        {% csrf_token %}
        <button class="btn btn-primary" type='submit'>تایید</button>
    </form>
    </div>
</div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    const select = document.getElementById("id_address");

    select.addEventListener("change", function () {
        if (this.value === "add_new") {
            window.location.href = "{% url 'add_address' %}";
        }
    });
});
</script>

<br><br><br>



</body>
</html>
{% endblock content %}

